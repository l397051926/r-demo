<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.gennlife.rws.dao.ActiveIndexTaskMapper" >
  <resultMap id="BaseResultMap" type="com.gennlife.rws.entity.ActiveIndexTask" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Oct 18 21:17:09 CST 2017.
    -->
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="active_index_id" property="activeIndexId" jdbcType="VARCHAR" />
    <result column="project_id" property="projectId" jdbcType="VARCHAR" />
    <result column="submit_time" property="submitTime" jdbcType="TIMESTAMP" />
    <result column="status" property="status" jdbcType="INTEGER" />
    <result column="message" property="message" jdbcType="VARCHAR" />
    <result column="complate_time" property="complateTime" jdbcType="TIMESTAMP" />
    <result column="case_total" property="caseTotal" jdbcType="INTEGER" />
    <result column="market_apply" property="marketApply" jdbcType="INTEGER" />
    <result column="search_result" property="searchResult" jdbcType="INTEGER" />
    <result column="contain_apply" property="containApply" jdbcType="INTEGER" />
    <result column="submit_num" property="submitNum" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Oct 18 21:17:09 CST 2017.
    -->
    id, active_index_id, project_id, submit_time, status, message, complate_time, case_total, 
    market_apply, search_result, contain_apply,submit_num
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Oct 18 21:17:09 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from active_index_task
    where id = #{id,jdbcType=VARCHAR}
  </select>
  <select id="findByActiveId" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select
    <include refid="Base_Column_List" />
    from active_index_task
    where active_index_id = #{activeId,jdbcType=VARCHAR} order by complate_time DESC limit 1
  </select>
  <select id="findByActiveIds" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select
    <include refid="Base_Column_List" />
    from active_index_task
    where active_index_id IN
    <foreach collection="list" item="item" index="index" separator="," open="(" close=")">
      #{activeId,jdbcType=VARCHAR}
    </foreach>

  </select>
  <select id="findByParam" resultMap="BaseResultMap" parameterType="java.lang.String">

    select
    <include refid="Base_Column_List" />
    from active_index_task
    <where>
      <if test="status!=null">
        status = #{status}
      </if>
      <if test="id!=null">
        AND id = #{id}
      </if>
      <if test="activeIndexId!=null">
        AND active_index_id = #{activeIndexId}
      </if>
      <if test="projectId!=null">
        AND project_id = #{projectId}
      </if>
    </where>
    order by submit_time DESC for UPDATE
  </select>
  <update id="updateTaskStatusToHistory" parameterType="java.lang.String">
    UPDATE active_index_task set status = 5 where status = 1 and  active_index_id = #{activeIndexId}
    and project_id = #{projectId}
  </update>
  <select id="findByActiveIdsAndStatus" resultMap="BaseResultMap" parameterType="java.util.List" >
    select
    <include refid="Base_Column_List" />
    from active_index_task
    <where>
      active_index_id IN
      <foreach collection="list" item="item" index="index" separator="," open="(" close=")">
        #{activeId,jdbcType=VARCHAR}
      </foreach>
      and status= 0
    </where>

  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Oct 18 21:17:09 CST 2017.
    -->
    delete from active_index_task
    where id = #{id,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.gennlife.rws.entity.ActiveIndexTask" >
    insert into active_index_task (id, active_index_id, project_id,
      submit_time, status, message, 
      complate_time, case_total, market_apply, 
      search_result, contain_apply,submit_num)
    values (#{id,jdbcType=VARCHAR}, #{activeIndexId,jdbcType=VARCHAR}, #{projectId,jdbcType=VARCHAR}, 
      #{submitTime,jdbcType=TIMESTAMP}, #{status,jdbcType=INTEGER}, #{message,jdbcType=VARCHAR}, 
      #{complateTime,jdbcType=TIMESTAMP}, #{caseTotal,jdbcType=INTEGER}, #{marketApply,jdbcType=INTEGER}, 
      #{searchResult,jdbcType=INTEGER}, #{containApply,jdbcType=INTEGER},#{submitNum,jdbcType=INTEGER})
  </insert>
  <insert id="replace" parameterType="com.gennlife.rws.entity.ActiveIndexTask" >
    replace into active_index_task (id, active_index_id, project_id,
      submit_time, status, message,
      complate_time, case_total, market_apply,
      search_result, contain_apply,submit_num)
    values (#{id,jdbcType=VARCHAR}, #{activeIndexId,jdbcType=VARCHAR}, #{projectId,jdbcType=VARCHAR},
      #{submitTime,jdbcType=TIMESTAMP}, #{status,jdbcType=INTEGER}, #{message,jdbcType=VARCHAR},
      #{complateTime,jdbcType=TIMESTAMP}, #{caseTotal,jdbcType=INTEGER}, #{marketApply,jdbcType=INTEGER},
      #{searchResult,jdbcType=INTEGER}, #{containApply,jdbcType=INTEGER},#{submitNum,jdbcType=INTEGER})
  </insert>
  <update id="updateTaskStatus" parameterType="java.lang.Object">
    update active_index_task set status = #{status},submit_time=now() where active_index_id=#{activeIndexId}
  </update>
  <insert id="insertSelective" parameterType="com.gennlife.rws.entity.ActiveIndexTask" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Oct 18 21:17:09 CST 2017.
    -->
    insert into active_index_task
    <trim prefix="(" suffix=")" suffixOverrides="," >
      id,
      <if test="activeIndexId != null" >
        active_index_id,
      </if>
      <if test="projectId != null" >
        project_id,
      </if>
      <if test="submitTime != null" >
        submit_time,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="message != null" >
        message,
      </if>
      <if test="complateTime != null" >
        complate_time,
      </if>
      <if test="caseTotal != null" >
        case_total,
      </if>
      <if test="marketApply != null" >
        market_apply,
      </if>
      <if test="searchResult != null" >
        search_result,
      </if>
      <if test="containApply != null" >
        contain_apply,
      </if>
      <if test="submitNum != null" >
        submit_num,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      #{id,jdbcType=VARCHAR},
      <if test="activeIndexId != null" >
        #{activeIndexId,jdbcType=VARCHAR},
      </if>
      <if test="projectId != null" >
        #{projectId,jdbcType=VARCHAR},
      </if>
      <if test="submitTime != null" >
        #{submitTime,jdbcType=TIMESTAMP},
      </if>
      <if test="status != null" >
        #{status,jdbcType=INTEGER},
      </if>
      <if test="message != null" >
        #{message,jdbcType=VARCHAR},
      </if>
      <if test="complateTime != null" >
        #{complateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="caseTotal != null" >
        #{caseTotal,jdbcType=INTEGER},
      </if>
      <if test="marketApply != null" >
        #{marketApply,jdbcType=INTEGER},
      </if>
      <if test="searchResult != null" >
        #{searchResult,jdbcType=INTEGER},
      </if>
      <if test="containApply != null" >
        #{containApply,jdbcType=INTEGER},
      </if>
      <if test="submitNum != null" >
        #{submitNum,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.gennlife.rws.entity.ActiveIndexTask" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Oct 18 21:17:09 CST 2017.
    -->
    update active_index_task
    <set >
      <if test="activeIndexId != null" >
        active_index_id = #{activeIndexId,jdbcType=VARCHAR},
      </if>
      <if test="projectId != null" >
        project_id = #{projectId,jdbcType=VARCHAR},
      </if>
      <if test="submitTime != null" >
        submit_time = #{submitTime,jdbcType=TIMESTAMP},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=INTEGER},
      </if>
      <if test="message != null" >
        message = #{message,jdbcType=VARCHAR},
      </if>
      <if test="complateTime != null" >
        complate_time = #{complateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="caseTotal != null" >
        case_total = #{caseTotal,jdbcType=INTEGER},
      </if>
      <if test="marketApply != null" >
        market_apply = #{marketApply,jdbcType=INTEGER},
      </if>
      <if test="searchResult != null" >
        search_result = #{searchResult,jdbcType=INTEGER},
      </if>
      <if test="containApply != null" >
        contain_apply = #{containApply,jdbcType=INTEGER},
      </if>
      <if test="submitNum != null" >
        submit_num = #{containApply,jdbcType=INTEGER},
      </if>
    </set>
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.gennlife.rws.entity.ActiveIndexTask" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Oct 18 21:17:09 CST 2017.
    -->
    update active_index_task
    set active_index_id = #{activeIndexId,jdbcType=VARCHAR},
      project_id = #{projectId,jdbcType=VARCHAR},
      submit_time = #{submitTime,jdbcType=TIMESTAMP},
      status = #{status,jdbcType=INTEGER},
      message = #{message,jdbcType=VARCHAR},
      complate_time = #{complateTime,jdbcType=TIMESTAMP},
      case_total = #{caseTotal,jdbcType=INTEGER},
      market_apply = #{marketApply,jdbcType=INTEGER},
      search_result = #{searchResult,jdbcType=INTEGER},
      contain_apply = #{containApply,jdbcType=INTEGER},
      submit_num=#{submitNum,jdbcType=INTEGER}
    where id = #{id,jdbcType=VARCHAR}
  </update>
</mapper>